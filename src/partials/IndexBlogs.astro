---
import { getTop, getBlogs } from '../libs/macrocms';
import * as Variables from '../variables.astro';
import BaseLayout from '../components/BaseLayout.astro';
import BaseTitle from '../components/BaseTitle.astro';
import Card from '../components/Card.astro';
import Button from '../components/Button.astro';
import ViewElement from '../components/ViewElement.astro';
import AnimationBlur from '../components/AnimationBlur.astro';

const topData = await getTop({
  fields: ['topBlogTitle'],
});

const BlogData = await getBlogs({
  fields: ['id', 'title', 'eyecatch', 'category'],
  limit: 5,
});

const title = topData.topBlogTitle;
const data = BlogData.contents;
---

<BaseLayout background="gray">
  <ViewElement ratio="-20%">
    <AnimationBlur>
      <BaseTitle title={title} />
    </AnimationBlur>
  </ViewElement>
  <ViewElement ratio="-20%">
    <AnimationBlur>
      <div class="container">
        <div class="blogs splide">
          <div class="splide__track">
            <div class="splide__list">
              {
                data.map((data: any) => {
                  return <Card BlogData={data} splide={true} />;
                })
              }
            </div>
          </div>
        </div>
        <div class="button">
          <Button
            type="gray"
            link={Variables.PAGES.blog.url}
            text="READ MORE"
          />
        </div>
      </div>
    </AnimationBlur>
  </ViewElement>
</BaseLayout>

<script>
  import { SplideSlide } from '../script/module/splide';
  SplideSlide();
</script>

<style lang="scss">
  @import '../styles/_single';

  .container {
    position: relative;
  }

  .blogs {
    margin: vw(30) 0 0;
  }

  .button {
    margin: vw(65) 0 0;
    text-align: center;
  }
</style>
<style lang="scss" is:global>
  @import '../styles/_single';

  .splide__arrows {
    svg {
      display: none;
    }
  }

  .splide__arrow--prev {
    &::before {
      position: absolute;
      bottom: vw(-135);
      left: vw(70);
      z-index: 100;
      width: vw(76);
      height: vw(76);
      content: '';
      background: url('../icons/arrow.svg') no-repeat center;
      border: 1px solid $color-base-black;
      border-radius: 50%;
      transform: rotate(180deg) !important;
    }

    &::after {
      position: absolute;
      bottom: vw(-210);
      left: vw(84);
      z-index: 100;
      width: vw(76);
      height: vw(76);
      font-weight: 700;
      content: 'Prev';
    }
  }

  .splide__arrow--next {
    &::before {
      position: absolute;
      bottom: vw(-135);
      left: vw(164);
      z-index: 100;
      width: vw(76);
      height: vw(76);
      content: '';
      background: url('../icons/arrow.svg') no-repeat center;
      border: 1px solid $color-base-black;
      border-radius: 50%;
    }

    &::after {
      position: absolute;
      bottom: vw(-210);
      left: vw(177);
      z-index: 100;
      width: vw(76);
      height: vw(76);
      font-weight: 700;
      letter-spacing: 0.02em;
      content: 'Next';
    }
  }

  // .splide__slide {
  //   opacity: 0.3;
  //   transition: 0.7s;
  // }

  // .splide__slide.is-active {
  //   opacity: 1;
  // }

  // .splide__pagination {
  //   gap: 0.5rem;
  //   margin: 1rem 0 0 !important;
  // }

  // .splide__pagination__page {
  //   width: 0.5rem;
  //   height: 0.5rem;
  //   background-color: gray;
  //   border-radius: 9999px;

  //   &is-active {
  //   }
  // }

  // .splide__pagination__page.is-active {
  //   background-color: white;
  // }
</style>
